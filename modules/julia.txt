RUN aptitude update
RUN aptitude install -y julia

RUN aptitude install -y build-essential libmagickwand-6.q16-2 python3 python3-dev python3-pip
RUN pip3 install jsonschema jinja2 tornado pyzmq ipython jupyter

RUN echo "#!/bin/bash" > /root/ijulia.sh
RUN echo "jupyter notebook --no-browser --certfile=/root/mycert.pem --keyfile=/root/mykey.key" >> /root/ijulia.sh
RUN chmod +x /root/ijulia.sh

RUN julia -e 'Pkg.add("Images")'
RUN julia -e 'Pkg.add("ImageMagick")'
RUN julia -e 'Pkg.add("IJulia")'
RUN julia -e 'Pkg.build("IJulia")'

COPY jupyter_notebook_config.py /root/.jupyter/jupyter_notebook_config.py
COPY mycert.pem /root/mycert.pem
COPY mykey.key /root/mykey.key
EXPOSE 9999
